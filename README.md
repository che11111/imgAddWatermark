# 批量水印添加工具

一个功能强大的批量水印添加工具，支持为目录下的所有图片文件快速添加水印。

![logo](./imgAddWatermark.png)

## 功能特性

- 🖼️ 支持多种图片格式：JPG, PNG, BMP, GIF
- 🎯 灵活的水印位置：左上、右上、左下、右下、居中
- 🔧 可调节的透明度和大小（水印大小支持从5%到100%）
- 👀 实时预览功能
- 📁 批量处理整个目录（支持递归扫描子文件夹）
- 🏠 保留原有目录层级结构输出
- 🧠 **智能检测功能** - 自动跳过已处理文件，避免重复处理
- 📊 进度显示和状态反馈
- 📂 **多种输出模式** - 灵活的输出目录管理
- 🎨 直观的图形界面

## 安装要求

- Python 3.7 或更高版本
- Pillow 图像处理库

## 安装步骤

1. 确保已安装 Python 3.7+
2. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```

## 使用方法

### 启动程序
```bash
python watermark_tool.py
```

### 操作步骤

1. **选择源目录**：点击"浏览"按钮选择包含图片的源目录
2. **选择水印文件**：选择要添加的水印图片（支持PNG、JPG等格式）
3. **选择输出模式**：在"输出和智能检测设置"中选择合适的输出模式
4. **调整设置**：
   - 选择水印位置（左上、右上、左下、右下、居中）
   - 调整透明度（10%-100%）
   - 调整水印大小（5%-100%）
5. **智能检测设置**：根据需要启用或禁用智能检测功能
6. **预览效果**：点击"预览效果"查看水印效果
7. **开始处理**：点击"开始添加水印"进行批量处理

## 水印设置说明

### 水印位置
- **左上角**：水印显示在图片左上角
- **右上角**：水印显示在图片右上角  
- **左下角**：水印显示在图片左下角
- **右下角**：水印显示在图片右下角（默认）
- **居中**：水印显示在图片中央

### 透明度
- 范围：10% - 100%
- 数值越小，水印越透明
- 建议范围：50% - 80%

### 水印大小
- 范围：5% - 100%（相对于图片最大边的比例）
- 水印会自动保持原始宽高比
- 建议范围：8% - 20%（小型水印）或50% - 80%（大型水印）

## 支持的文件格式

### 输入格式
- JPEG (.jpg, .jpeg)
- PNG (.png)
- BMP (.bmp)
- GIF (.gif)

### 输出格式
- 保持原始格式，或根据文件扩展名自动选择
- JPEG格式：高质量压缩（95%质量）
- PNG格式：优化压缩

## 使用技巧

1. **批量处理**：程序会自动扫描源目录中的所有支持格式的图片文件
2. **安全处理**：原始文件不会被修改，所有处理结果保存到输出目录
3. **预览功能**：建议在批量处理前先使用预览功能确认效果
4. **水印文件**：建议使用PNG格式的透明背景水印以获得最佳效果
5. **输出目录**：如果输出目录不存在，程序会自动创建

## 注意事项

- 处理大量文件时请保持程序运行，不要关闭窗口
- 水印文件建议使用透明背景的PNG格式
- 如果遇到某个文件处理失败，程序会跳过该文件继续处理其他文件
- 输出文件名与原文件名相同，如有同名文件会被覆盖

## 故障排除

### 常见问题

**Q: 程序无法启动**
A: 请确保已安装Python和Pillow库

**Q: 某些图片处理失败**
A: 检查图片文件是否损坏，或格式是否支持

**Q: 水印效果不理想**
A: 调整透明度和大小设置，或更换水印文件

**Q: 处理速度较慢**
A: 这是正常现象，处理速度取决于图片数量和大小

## 版本信息

- 版本：2.0
- 最后更新：2024-08-30
- 开发语言：Python + Tkinter + Pillow


## 智能检测功能

### 智能跳过已处理文件
- **功能说明**：程序会自动检测源目录中的/watermarked子目录，比对已处理的文件
- **智能匹配**：根据文件名和相对路径进行匹配，支持子文件夹结构
- **高效处理**：避免重复处理，大大提高批量处理效率

### 多种输出模式
1. **输出到 /watermarked 目录**：默认模式，输出到源目录下的watermarked子目录
2. **输出到 /watermarked_new 目录**：输出到新的watermarked_new子目录，不覆盖已有文件
3. **输出到指定目录**：
   - 点击该选项时会自动弹出目录选择对话框
   - 显示自定义目录输入框和“浏览”按钮
   - 可随时点击“浏览”按钮重新选择目录
   - 选中的目录路径会实时显示在输入框中

### 使用场景
- **增量更新**：定期向目录添加新图片，只处理新添加的文件
- **批量重新处理**：更改水印设置后，使用watermarked_new模式避免覆盖原文件
- **大量文件处理**：处理被中断的任务，程序会自动从中断处继续